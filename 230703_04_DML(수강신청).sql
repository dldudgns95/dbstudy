--테이블 삭제
DROP TABLE LECTURE_TBL;
DROP TABLE ENROLL_TBL;
DROP TABLE COURSE_TBL;
DROP TABLE STUDENT_TBL;
DROP TABLE PROFESSOR_TBL;

--1. 교수 테이블 생성
CREATE TABLE PROFESSOR_TBL(
    PRFS_NO    NUMBER       NOT NULL,
    PRFS_NAME  VARCHAR2(15) NOT NULL,
    PRFS_MAJOR VARCHAR2(30),
    CONSTRAINT PK_PROFESSOR PRIMARY KEY(PRFS_NO)
);

--2. 학생 테이블 생성
CREATE TABLE STUDENT_TBL(
    STD_NO     NUMBER       NOT NULL,
    STD_NAME   VARCHAR2(15) NOT NULL,
    STD_ADRESS VARCHAR2(30),
    STD_GRADE  NUMBER(1),
    PRFS_NO    NUMBER       NOT NULL,
    CONSTRAINT PK_STUDENT PRIMARY KEY(STD_NO),
    CONSTRAINT FK_PROFESSOR_STUDENT FOREIGN KEY(PRFS_NO) REFERENCES PROFESSOR_TBL(PRFS_NO)
);


--3. 과목 테이블 생성
CREATE TABLE COURSE_TBL(
    CS_NO   NUMBER    NOT NULL,
    CS_NAME VARCHAR2(30),
    CS_GP   NUMBER(2) NOT NULL,
    CONSTRAINT PK_COURSE PRIMARY KEY(CS_NO)
);

--4. 수강신청 테이블 생성
CREATE TABLE ENROLL_TBL(
    ENR_NO   NUMBER NOT NULL,
    STD_NO   NUMBER NOT NULL,
    CS_NO    NUMBER NOT NULL,
    ENR_DATE DATE,
    CONSTRAINT PK_ENROLL PRIMARY KEY(ENR_NO),
    CONSTRAINT FK_STUDENT_ENROLL FOREIGN KEY(STD_NO) REFERENCES STUDENT_TBL(STD_NO) ON DELETE CASCADE,
    CONSTRAINT FK_COURSE_ENROLL  FOREIGN KEY(CS_NO)  REFERENCES COURSE_TBL(CS_NO)   ON DELETE CASCADE
);

--5. 강의 테이블 생성
CREATE TABLE LECTURE_TBL(
    LCT_NO   NUMBER NOT NULL,
    PRFS_NO  NUMBER,
    ENR_NO   NUMBER,
    LCT_NAME VARCHAR2(30),
    LCT_ROOM VARCHAR2(30),
    CONSTRAINT PK_LECTURE PRIMARY KEY(LCT_NO),
    CONSTRAINT FK_PROFESSOR_LECTURE FOREIGN KEY(PRFS_NO) REFERENCES PROFESSOR_TBL(PRFS_NO) ON DELETE SET NULL,
    CONSTRAINT FK_ENROLL_LECTURE    FOREIGN KEY(ENR_NO)  REFERENCES ENROLL_TBL(ENR_NO)     ON DELETE SET NULL
);

--1. 교수 데이터 입력
INSERT INTO PROFESSOR_TBL VALUES(4,'교수1','DB'  );
INSERT INTO PROFESSOR_TBL VALUES(5,'교수2','JAVA');
INSERT INTO PROFESSOR_TBL VALUES(6,'교수3','C++' );
COMMIT;

--1. 교수 데이터 출력
SELECT * FROM PROFESSOR_TBL;

--2. 학생 데이터 입력
INSERT INTO STUDENT_TBL VALUES(123,'철수'  ,'경기도',3,6);
INSERT INTO STUDENT_TBL VALUES(456,'영희'  ,'서울시',2,6);
INSERT INTO STUDENT_TBL VALUES(789,'이영훈','전라도',1,4);
COMMIT;

--2. 학생 데이터 출력
SELECT * FROM STUDENT_TBL;

--3. 과목 데이터 입력
INSERT INTO COURSE_TBL VALUES(1,'데이터베이스',3);
INSERT INTO COURSE_TBL VALUES(2,'자바',        5);
INSERT INTO COURSE_TBL VALUES(3,'C언어',       4);
COMMIT;

--3. 과목 데이터 출력
SELECT * FROM COURSE_TBL;

--4. 수강신청번호 시퀀스 만들기
DROP SEQUENCE   ENROLL_SEQ;
CREATE SEQUENCE ENROLL_SEQ ORDER;

--4. 수강신청 데이터 입력
INSERT INTO ENROLL_TBL VALUES(ENROLL_SEQ.NEXTVAL,789,1,'23-07-01');
INSERT INTO ENROLL_TBL VALUES(ENROLL_SEQ.NEXTVAL,123,3,'23-06-01');
INSERT INTO ENROLL_TBL VALUES(ENROLL_SEQ.NEXTVAL,456,2,'23-05-01');
COMMIT;

--4. 수강신청 데이터 출력
SELECT * FROM ENROLL_TBL;

--5. 강의번호 시퀀스 만들기
DROP SEQUENCE   LECTURE_SEQ;
CREATE SEQUENCE LECTURE_SEQ ORDER;

--5. 강의 데이터 입력
INSERT INTO LECTURE_TBL VALUES(LECTURE_SEQ.NEXTVAL,5,3,'C언어',       '201호');
INSERT INTO LECTURE_TBL VALUES(LECTURE_SEQ.NEXTVAL,4,1,'데이터베이스','301호');
INSERT INTO LECTURE_TBL VALUES(LECTURE_SEQ.NEXTVAL,5,2,'자바',        '401호');
COMMIT;

--5. 강의 데이터 출력
SELECT * FROM LECTURE_TBL;